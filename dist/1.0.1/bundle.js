(()=>{"use strict";const e=function(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),s=1;s<arguments.length;s++){var n=arguments[s];if(null!=n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])}return r},writable:!0,configurable:!0});var e={addToParent:function(e,t,r){if(e[t]){if(!Array.isArray(e[t])){var s=e[t];e[t]=[],e[t].push(s)}e[t].push(r)}else e[t]=r},convertXMLStringToDoc:function(e){var t=null;return e&&"string"==typeof e&&(t=(new DOMParser).parseFromString(e,"application/xml")),t},isXML:function(e){var t=(e?e.ownerDocument||e:0).documentElement;return!!t&&"html"!==t.nodeName.toLowerCase()},parseAttributes:function(t){var r=t.attributes,s={};if(t.hasAttributes())for(var n=0;n<r.length;n++)s[r[n].name]=e.parseValue(r[n].value);return s},parseChildren:function(t,r){if(r.length>0)for(var s=0;s<r.length;s++)1==r[s].nodeType&&e.parseNode(t,r[s])},parseNode:function(t,r){var s=r.nodeName,n=Object.assign({},e.parseAttributes(r));return 1==r.childNodes.length&&3==r.childNodes[0].nodeType?r.hasAttributes()?n.text=e.parseValue(r.childNodes[0].nodeValue):n=e.parseValue(r.childNodes[0].nodeValue):e.parseChildren(n,r.childNodes),e.addToParent(t,s,n),t},parseValue:function(e){if("0"==e.charAt(0))var t=NaN;else t=Number(e);return"true"===e.toLowerCase()||"false"===e.toLowerCase()?"true"==e.toLowerCase():isNaN(t)?e.trim():0==e.length?null:t}};return{parse:function(t){var r=!0;try{JSON.parse(t)}catch(e){r=!1}if(r)return null;t&&"string"==typeof t&&(t=e.convertXMLStringToDoc(t));var s=function(e){return Object.keys(e).map((function(t){e[t]instanceof Object?Object.keys(e[t]).length||"function"==typeof e[t].getMonth?s(e[t]):delete e[t]:null===e[t]&&delete e[t]})),e};return t&&e.isXML(t)?s(e.parseNode({},t.firstChild)):null}}}();function t(e,t,r,s,n,o){this.ajaxURL=e,this.senderid=t||"null",this.senderpwd=r||"null",this.controlid=s||"controlid",this.uniqueid=n||"false",this.dtdversion=o||"3.0",this.lastRequest="",this.lastResponse="",!e&&window.gSess&&(this.sessionid=window.gSess,this.ajaxURL="../xml/ajaxgw.phtml?.sess="+window.gSess)}function r(e,t){if(!e)return null;var r=e.indexOf("<"+t+">");if(r<0)return null;r+=2+t.length;var s=e.indexOf("</"+t+">",r);return s<0?null:e.substring(r,s)}console.log(jed),t.prototype.ip_setCredentials=function(e,t,r,s,n){this.companyid=e,this.userid=t,this.password=r,this.clientid=s||"",this.locationid=n||"",e&&t&&r&&(this.sessionid=null)},t.prototype.ip_setSessionID=function(e){this.sessionid=e,this.ajaxURL="../xml/ajaxgw.phtml?.sess="+e},t.prototype.ip_getLastRequest=function(){return this.lastRequest},t.prototype.ip_setErrorProc=function(e){this.errorProc=e},t.prototype.ip_read=function(e,t,r,s,n,o){var i="<read>"+this.xmlNode("object",e)+this.xmlNode("fields",t)+this.xmlNode("keys",r)+this.xmlNode("returnFormat",s)+this.xmlNode("docparid",n)+"</read>";this.sendRequest(i,o)},t.prototype.ip_readByName=function(e,t,r,s,n){var o="<readByName>"+this.xmlNode("object",e)+this.xmlNode("fields",t)+this.xmlNode("keys",r)+this.xmlNode("returnFormat",s)+"</readByName>";this.sendRequest(o,n)},t.prototype.ip_readByQuery=function(e,t,r,s,n,o,i,a){try{var d="<readByQuery>"+this.xmlNode("object",e)+this.xmlNode("fields",t)+this.xmlNode("query",r)+this.xmlNode("pagesize",s)+this.xmlNode("returnFormat",n);if(null!=a&&(d+=this.xmlNode("docparid",a)),d+="</readByQuery>",i)return this.sendRequestWithPromise(d);this.sendRequest(d,o)}catch(e){if(i)return jq.Deferred().reject(e);throw e}},t.prototype.ip_readView=function(e,t,r,s,n){var o="<readView>"+this.xmlNode("view",e)+(null!=r?this.xmlNode("pagesize",r):"")+(null!=s?this.xmlNode("returnFormat",s):"")+(null!=t?this.processFields({filters:t}):"")+"</readView>";this.sendRequest(o,n)},t.prototype.ip_readMore=function(e,t,r){var s="<readMore>"+this.xmlNode(null==r?"object":r,e)+"</readMore>";this.sendRequest(s,t)},t.prototype.ip_readMoreObject=function(e,t){this.ip_readMore(e,t,"object")},t.prototype.ip_readMoreView=function(e,t){this.ip_readMore(e,t,"view")},t.prototype.ip_readRelated=function(e,t,r,s,n,o){var i="<readRelated>"+this.xmlNode("object",e)+this.xmlNode("keys",t)+this.xmlNode("relation",r)+this.xmlNode("fields",s)+this.xmlNode("returnFormat",n)+"</readRelated>";this.sendRequest(i,o)},t.prototype.ip_create=function(e,t,r){var s="<create><"+e+">";s+=this.processFields(t),s+="</"+e+"></create>",this.sendRequest(s,r)},t.prototype.ip_createXML=function(e,t){var r="<create>"+e+"</create>";this.sendRequest(r,t)},t.prototype.ip_update=function(e,t,r){var s="<update><"+e+">";s+=this.processFields(t),s+="</"+e+"></update>",this.sendRequest(s,r)},t.prototype.ip_updateXML=function(e,t){var r="<update>"+e+"</update>";this.sendRequest(r,t)},t.prototype.ip_delete=function(e,t,r){var s="<delete>"+this.xmlNode("object",e)+this.xmlNode("keys",t)+"</delete>";this.sendRequest(s,r)},t.prototype.ip_inspect=function(e,t,r){var s=(t?'<inspect detail="1">':"<inspect>")+this.xmlNode("object",e)+"</inspect>";this.sendRequest(s,r)},t.prototype.getXMLHTTPRequest=function(){var e=!1;if(window.XMLHttpRequest)e=new XMLHttpRequest;else if("undefined"!=typeof ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}return e},t.prototype.xmlEncode=function(e){return e?(e=String(e)).replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&apos;").replace(/\"/g,"&quot;"):""},t.prototype.xmlNode=function(e,t){return e?"<"+e+">"+this.xmlEncode(t)+"</"+e+">":""},t.prototype.getRecHeader=function(){var e='<?xml version="1.0" encoding="UTF-8"?><request>';return e+="<control><senderid>"+this.xmlEncode(this.senderid)+"</senderid><password>"+this.xmlEncode(this.senderpwd)+"</password><controlid>"+this.xmlEncode(this.controlid)+"</controlid><uniqueid>"+this.xmlEncode(this.uniqueid)+"</uniqueid><dtdversion>"+this.xmlEncode(this.dtdversion)+"</dtdversion></control>",e+="<operation>",e+="<authentication>",this.sessionid?e+=this.xmlNode("sessionid",this.sessionid):(e+="<login>",e+=this.xmlNode("userid",this.userid),e+=this.xmlNode("companyid",this.companyid),e+=this.xmlNode("password",this.password),this.clientid&&(e+=this.xmlNode("clientid",this.clientid)),this.locationid&&(e+=this.xmlNode("locationid",this.locationid)),e+="</login>"),(e+="</authentication>")+'<content><function controlid="'+this.xmlEncode(this.controlid)+'">'},t.prototype.getRecFooter=function(){return"</function></content></operation></request>"},t.prototype.sendRequest=function(e,t){var r=this.getRecHeader()+e+this.getRecFooter();this.lastRequest=r;var s=this.getXMLHTTPRequest();if(!s)throw"Cannot create XMLHTTPRequest";var n=this.checkError,o=this.errorProc?this.errorProc:function(e){alert(GT("IA.ERROR")+": "+e)};s.onreadystatechange=function(){if(4==s.readyState){if(n(s.responseText,o))return;t&&t(s.responseText)}};var i=this.ajaxURL;s.open("POST",i,!1);var a="xmlrequest="+encodeURIComponent(r);s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.setRequestHeader("Content-length",a.length),s.setRequestHeader("Connection","close"),s.send(a)},t.prototype.sendRequestWithPromise=function(t,r,s,n){if(Array.isArray(t))var o="header"!=s,i="header"==s||"none"==s,a=this.getRecHeader(r,o)+this.getRecContent(t,i)+this.getRecFooter(o);else o="content"==s||"none"==s,a=this.getRecHeader(r,o)+t+this.getRecFooter(o);this.lastRequest=a;var d=this.getXMLHTTPRequest();if(!d)throw"Cannot create XMLHTTPRequest";var c=this.ajaxURL;d.open("POST",c,!1);var l="xmlrequest="+encodeURIComponent(a);if(d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.send(l),4==d.readyState){var u=null;if(0!=n&&null!=n||(u=this.getErrorMessage(d.responseText)),null!=u)return{type:"error",message:u};var p=e.parse(d.responseText);if(null==p&&(p=JSON.parse(d.responseText)),0==n||null==n)try{if(!Array.isArray(p.response.operation.result)&&"failure"==p.response.operation.result.status)return"Unknown error occurred contacting Intacct on function"}catch(e){}return{type:"success",message:p}}},t.prototype.getErrorMessage=function(e){this.lastResponse=new String(e);var t,s,n,o=r(e,"errormessage");if(!o)return null;parser=new DOMParser,xmlDoc=parser.parseFromString(e,"text/xml");var i=xmlDoc.getElementsByTagName("error"),a=Array.from(i),d=a.length>1?"Multiple errors exist - the first one is being presented\n":"",c=new Array;a.forEach(((e,r)=>{if(null!=e.children){for(var o={},i=0;i<e.children.length;i++)o[e.children[i].tagName]=e.children[i].textContent;c.push(o)}t=c[0].description,s=c[0].description2,n=c[0].correction,c[0].errorno})),null!=this.logger&&(this.logger.writeEntry("ERROR => Intacct API Errors Occurred ("+c.length+" Total) :"),c.forEach(((e,t)=>{var r=t+1;this.logger.writeEntry("-- Intacct Error #"+r+" --"),this.logger.writeEntry("desc: "+e.description),this.logger.writeEntry("desc2: "+e.description2),this.logger.writeEntry("corr: "+e.correction),this.logger.writeEntry("errno: "+e.errorno),this.logger.addError("desc: "+e.description+" | desc2: "+e.description2+" | corr: "+e.correction+" | errno: "+e.errorno)}))),t||s||n?(message="",d&&(message=message+d+"\n"),t&&(message=message+t+"\n\n"),s&&(message=message+s+"\n\n"),n&&(message=message+n+"\n\n")):message=o;var l=document.createElement("textarea");return l.innerHTML=message,l.value.trim()},t.prototype.checkError=function(e,t){this.lastResponse=new String(e);var s=r(e,"errormessage");if(!s)return!1;var n=r(s,"description"),o=r(s,"description2"),i=r(s,"correction");n||o||i?(message="",n&&(message=message+n+"\n\n"),o&&(message=message+o+"\n\n"),i&&(message=message+i+"\n\n")):message=s;var a=document.createElement("textarea");return a.innerHTML=message,t&&t(a.value.trim()),!0},t.prototype.processFields=function(e){var t="";if(e instanceof Array)for(var r=0;r<e.length;r++)t+=this.processOneField(e,r);else for(var r in e)t+=this.processOneField(e,r);return t},t.prototype.processOneField=function(e,t){var r="",s=t,n=e instanceof Array,o=e[t],i=typeof o;return null==o?r:r+="object"==i||"array"==i?n?this.processFields(o):"<"+s+">"+this.processFields(o)+"</"+s+">":this.xmlNode(s,o)},window.API_Internal_Session=t})();