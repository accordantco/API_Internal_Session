(()=>{var e={993:()=>{"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),s=1;s<arguments.length;s++){var o=arguments[s];if(null!=o)for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(r[n]=o[n])}return r},writable:!0,configurable:!0}),function(){var e=this;e.addToParent=function(e,t,r){if(e[t]){if(!Array.isArray(e[t])){var s=e[t];e[t]=[],e[t].push(s)}e[t].push(r)}else e[t]=r},e.convertXMLStringToDoc=function(e){var t=null;return e&&"string"==typeof e&&(t=(new DOMParser).parseFromString(e,"application/xml")),t},e.isXML=function(e){var t=(e?e.ownerDocument||e:0).documentElement;return!!t&&"html"!==t.nodeName.toLowerCase()},e.parseAttributes=function(t){var r=t.attributes,s={};if(t.hasAttributes())for(var o=0;o<r.length;o++)s[r[o].name]=e.parseValue(r[o].value);return s},e.parseChildren=function(t,r){if(r.length>0)for(var s=0;s<r.length;s++)1==r[s].nodeType&&e.parseNode(t,r[s])},e.parseNode=function(t,r){var s=r.nodeName,o=Object.assign({},e.parseAttributes(r));return 1==r.childNodes.length&&3==r.childNodes[0].nodeType?r.hasAttributes()?o.text=e.parseValue(r.childNodes[0].nodeValue):o=e.parseValue(r.childNodes[0].nodeValue):e.parseChildren(o,r.childNodes),e.addToParent(t,s,o),t},this.parseValue=function(e){if("0"==e.charAt(0))var t=NaN;else t=Number(e);return"true"===e.toLowerCase()||"false"===e.toLowerCase()?"true"==e.toLowerCase():isNaN(t)?e.trim():0==e.length?null:t}}()}},t={};function r(s){var o=t[s];if(void 0!==o)return o.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,r),n.exports}(()=>{"use strict";function e(e,t,r,s,o,n){this.ajaxURL=e,this.senderid=t||"null",this.senderpwd=r||"null",this.controlid=s||"controlid",this.uniqueid=o||"false",this.dtdversion=n||"3.0",this.lastRequest="",this.lastResponse="",!e&&window.gSess&&(this.sessionid=window.gSess,this.ajaxURL="../xml/ajaxgw.phtml?.sess="+window.gSess)}function t(e,t){if(!e)return null;var r=e.indexOf("<"+t+">");if(r<0)return null;r+=2+t.length;var s=e.indexOf("</"+t+">",r);return s<0?null:e.substring(r,s)}e.prototype.ip_setCredentials=function(e,t,r,s,o){this.companyid=e,this.userid=t,this.password=r,this.clientid=s||"",this.locationid=o||"",e&&t&&r&&(this.sessionid=null)},e.prototype.ip_setSessionID=function(e){this.sessionid=e,this.ajaxURL="../xml/ajaxgw.phtml?.sess="+e},e.prototype.ip_getLastRequest=function(){return this.lastRequest},e.prototype.ip_setErrorProc=function(e){this.errorProc=e},e.prototype.ip_read=function(e,t,r,s,o,n){var i="<read>"+this.xmlNode("object",e)+this.xmlNode("fields",t)+this.xmlNode("keys",r)+this.xmlNode("returnFormat",s)+this.xmlNode("docparid",o)+"</read>";this.sendRequest(i,n)},e.prototype.ip_readByName=function(e,t,r,s,o){var n="<readByName>"+this.xmlNode("object",e)+this.xmlNode("fields",t)+this.xmlNode("keys",r)+this.xmlNode("returnFormat",s)+"</readByName>";this.sendRequest(n,o)},e.prototype.ip_readByQuery=function(e,t,r,s,o,n,i,a){try{var d="<readByQuery>"+this.xmlNode("object",e)+this.xmlNode("fields",t)+this.xmlNode("query",r)+this.xmlNode("pagesize",s)+this.xmlNode("returnFormat",o);if(null!=a&&(d+=this.xmlNode("docparid",a)),d+="</readByQuery>",i)return this.sendRequestWithPromise(d);this.sendRequest(d,n)}catch(e){if(i)return jq.Deferred().reject(e);throw e}},e.prototype.ip_readView=function(e,t,r,s,o){var n="<readView>"+this.xmlNode("view",e)+(null!=r?this.xmlNode("pagesize",r):"")+(null!=s?this.xmlNode("returnFormat",s):"")+(null!=t?this.processFields({filters:t}):"")+"</readView>";this.sendRequest(n,o)},e.prototype.ip_readMore=function(e,t,r){var s="<readMore>"+this.xmlNode(null==r?"object":r,e)+"</readMore>";this.sendRequest(s,t)},e.prototype.ip_readMoreObject=function(e,t){this.ip_readMore(e,t,"object")},e.prototype.ip_readMoreView=function(e,t){this.ip_readMore(e,t,"view")},e.prototype.ip_readRelated=function(e,t,r,s,o,n){var i="<readRelated>"+this.xmlNode("object",e)+this.xmlNode("keys",t)+this.xmlNode("relation",r)+this.xmlNode("fields",s)+this.xmlNode("returnFormat",o)+"</readRelated>";this.sendRequest(i,n)},e.prototype.ip_create=function(e,t,r){var s="<create><"+e+">";s+=this.processFields(t),s+="</"+e+"></create>",this.sendRequest(s,r)},e.prototype.ip_createXML=function(e,t){var r="<create>"+e+"</create>";this.sendRequest(r,t)},e.prototype.ip_update=function(e,t,r){var s="<update><"+e+">";s+=this.processFields(t),s+="</"+e+"></update>",this.sendRequest(s,r)},e.prototype.ip_updateXML=function(e,t){var r="<update>"+e+"</update>";this.sendRequest(r,t)},e.prototype.ip_delete=function(e,t,r){var s="<delete>"+this.xmlNode("object",e)+this.xmlNode("keys",t)+"</delete>";this.sendRequest(s,r)},e.prototype.ip_inspect=function(e,t,r){var s=(t?'<inspect detail="1">':"<inspect>")+this.xmlNode("object",e)+"</inspect>";this.sendRequest(s,r)},e.prototype.getXMLHTTPRequest=function(){var e=!1;if(window.XMLHttpRequest)e=new XMLHttpRequest;else if("undefined"!=typeof ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){e=!1}}return e},e.prototype.xmlEncode=function(e){return e?(e=String(e)).replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&apos;").replace(/\"/g,"&quot;"):""},e.prototype.xmlNode=function(e,t){return e?"<"+e+">"+this.xmlEncode(t)+"</"+e+">":""},e.prototype.getRecHeader=function(){var e='<?xml version="1.0" encoding="UTF-8"?><request>';return e+="<control><senderid>"+this.xmlEncode(this.senderid)+"</senderid><password>"+this.xmlEncode(this.senderpwd)+"</password><controlid>"+this.xmlEncode(this.controlid)+"</controlid><uniqueid>"+this.xmlEncode(this.uniqueid)+"</uniqueid><dtdversion>"+this.xmlEncode(this.dtdversion)+"</dtdversion></control>",e+="<operation>",e+="<authentication>",this.sessionid?e+=this.xmlNode("sessionid",this.sessionid):(e+="<login>",e+=this.xmlNode("userid",this.userid),e+=this.xmlNode("companyid",this.companyid),e+=this.xmlNode("password",this.password),this.clientid&&(e+=this.xmlNode("clientid",this.clientid)),this.locationid&&(e+=this.xmlNode("locationid",this.locationid)),e+="</login>"),(e+="</authentication>")+'<content><function controlid="'+this.xmlEncode(this.controlid)+'">'},e.prototype.getRecFooter=function(){return"</function></content></operation></request>"},e.prototype.sendRequest=function(e,t){var r=this.getRecHeader()+e+this.getRecFooter();this.lastRequest=r;var s=this.getXMLHTTPRequest();if(!s)throw"Cannot create XMLHTTPRequest";var o=this.checkError,n=this.errorProc?this.errorProc:function(e){alert(GT("IA.ERROR")+": "+e)};s.onreadystatechange=function(){if(4==s.readyState){if(o(s.responseText,n))return;t&&t(s.responseText)}};var i=this.ajaxURL;s.open("POST",i,!1);var a="xmlrequest="+encodeURIComponent(r);s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.setRequestHeader("Content-length",a.length),s.setRequestHeader("Connection","close"),s.send(a)},e.prototype.sendRequestWithPromise=function(e,t,r,s){if(Array.isArray(e))var o="header"!=r,n="header"==r||"none"==r,i=this.getRecHeader(t,o)+this.getRecContent(e,n)+this.getRecFooter(o);else o="content"==r||"none"==r,i=this.getRecHeader(t,o)+e+this.getRecFooter(o);this.lastRequest=i;var a=this.getXMLHTTPRequest();if(!a)throw"Cannot create XMLHTTPRequest";var d=this.ajaxURL;a.open("POST",d,!1);var c="xmlrequest="+encodeURIComponent(i);if(a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.send(c),4==a.readyState){var l=null;if(0!=s&&null!=s||(l=this.getErrorMessage(a.responseText)),null!=l)return{type:"error",message:l};var u=xmlToJson.parse(a.responseText);if(null==u&&(u=JSON.parse(a.responseText)),0==s||null==s)try{if(!Array.isArray(u.response.operation.result)&&"failure"==u.response.operation.result.status)return"Unknown error occurred contacting Intacct on function"}catch(e){}return{type:"success",message:u}}},e.prototype.getErrorMessage=function(e){this.lastResponse=new String(e);var r,s,o,n=t(e,"errormessage");if(!n)return null;parser=new DOMParser,xmlDoc=parser.parseFromString(e,"text/xml");var i=xmlDoc.getElementsByTagName("error"),a=Array.from(i),d=a.length>1?"Multiple errors exist - the first one is being presented\n":"",c=new Array;a.forEach(((e,t)=>{if(null!=e.children){for(var n={},i=0;i<e.children.length;i++)n[e.children[i].tagName]=e.children[i].textContent;c.push(n)}r=c[0].description,s=c[0].description2,o=c[0].correction,c[0].errorno})),null!=this.logger&&(this.logger.writeEntry("ERROR => Intacct API Errors Occurred ("+c.length+" Total) :"),c.forEach(((e,t)=>{var r=t+1;this.logger.writeEntry("-- Intacct Error #"+r+" --"),this.logger.writeEntry("desc: "+e.description),this.logger.writeEntry("desc2: "+e.description2),this.logger.writeEntry("corr: "+e.correction),this.logger.writeEntry("errno: "+e.errorno),this.logger.addError("desc: "+e.description+" | desc2: "+e.description2+" | corr: "+e.correction+" | errno: "+e.errorno)}))),r||s||o?(message="",d&&(message=message+d+"\n"),r&&(message=message+r+"\n\n"),s&&(message=message+s+"\n\n"),o&&(message=message+o+"\n\n")):message=n;var l=document.createElement("textarea");return l.innerHTML=message,l.value.trim()},e.prototype.checkError=function(e,r){this.lastResponse=new String(e);var s=t(e,"errormessage");if(!s)return!1;var o=t(s,"description"),n=t(s,"description2"),i=t(s,"correction");o||n||i?(message="",o&&(message=message+o+"\n\n"),n&&(message=message+n+"\n\n"),i&&(message=message+i+"\n\n")):message=s;var a=document.createElement("textarea");return a.innerHTML=message,r&&r(a.value.trim()),!0},e.prototype.processFields=function(e){var t="";if(e instanceof Array)for(var r=0;r<e.length;r++)t+=this.processOneField(e,r);else for(var r in e)t+=this.processOneField(e,r);return t},e.prototype.processOneField=function(e,t){var r="",s=t,o=e instanceof Array,n=e[t],i=typeof n;return null==n?r:r+="object"==i||"array"==i?o?this.processFields(n):"<"+s+">"+this.processFields(n)+"</"+s+">":this.xmlNode(s,n)},r(993)})()})();